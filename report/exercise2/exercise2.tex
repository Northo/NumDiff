\section{Heat equation in one dimension}
In this section, we consider the one-dimensional heat equation for $u = u(x, t)$, 
\begin{equation*}
    u_t = u_{xx}, \quad u(x, 0) = f(x), \quad x \in [0,1] := \Omega, 
    \label{eq:heat-eq}
\end{equation*}
with either Neumann or Dirchelet boundaryconditions, 
and solve it numerically using both the Backward Euler method and Crank-Nicolson method. 
These are $\mathcal{O}(k+h^2)$ and $\mathcal{O}(k^2+h^2)$ methods respectively, 
and we will analyze and compare the convergence of the two methods using mesh refinement as we did in section \ref{task_1}. 

\subsection{Numerical solution method}
To solve the heat equation numerically we first perform semi-discretization, 
i.e. we do spatial discretization and keep the time continous. 
The interval $\Omega$ is divided into $M$Â equidistant points with sepparation $h=1/(M-1)$, 
as described in section \ref{task_1}, 
and we approximate the spatial derivative with central finite differences. 
Introducing $v_m(t), m = 0, ..., M$ as approximations to $u(x_m, t)$, 
the result is now that we have gone from a PDE to a system of ODEs, 
\begin{equation*}
    \frac{dv_m(t)}{dt} = \frac{1}{h^2} \delta_x^2 v_m(t), 
    \quad v_m(0) = f(x_m). 
\end{equation*}

The problem is then generally solved by imposing the boundary conditions, 
and numerically integrating the equations in time, 
using e.g. Euler's method. 
For convenience we employ the $\theta$-method, 
\begin{equation*}
    General theta method, 
\end{equation*}
and obtain 
\begin{equation}
    theta method for heat equation.
    \label{eq:theta-heat}
\end{equation}
Integrating with constant time step $k$ results in a uniform grid for the time interval as well. 
As for the spatial grid, we divide the time interval into $N$ equidistant points, 
so that we approximate the solution at $N$ finite times $t_n = nk, \quad n = 1, \ldots N$, 
\quad $k = 1/(N-1)$. 

\begin{figure}[ht]
    \centering
    \input{exercise2/grid_figure.pgf}
\end{figure}

Setting the value of $\theta$ in \eqref{eq:theta-heat} determines the specific numerical scheme, 
we have
\begin{equation*}
\begin{split}
    \text{Forward Euler} \quad \theta = 0 \\
    \text{Backward Euler} \quad \theta = 1 \\
    \text{Crank-Nicolson} \quad \theta = \frac{1}{2}, \\
\end{split}
\end{equation*}
and we will as mentioned consider the Bacward-Euler and Crank-Nicolson methods. 

Imposing boundary conditions and some matrix equations here I guess.

We start by considering the heat equation with the following Neumann boundary conditions and initial condition, 
\begin{equation}
    u_x(0,t) = u_x(1,t) = 0, \quad u(x,0) = 2\pi x - \sin(2\pi x),
    \label{eq:2a}
\end{equation}

\begin{figure}[ht]
    \centering
    \input{exercise2/2a_surface_plot.pgf}
    \caption{I am a surface plot, Hooray :)}
\end{figure}

\subsection{Convergence and mesh refinement}
For \eqref{eq:2a}, the the analytical solution is not available in closed form, 
so in order to analyze convergence we compute a reference solution using a sufficiently high $M$, 
which we use in place of the analytical solution when computing the error. 

In order to analyze the convergence further, 
we now consider the heat equation with a set of boundary and initial conditions for which the analytical solution is known. 
Specifically we consider 
\begin{equation}
    u_t = u_{xx}, \quad u(0,t) = u(1,t) = 0, \quad u(x,0) = \sin(\pi x), 
    \label{eq:2b-manufactured}
\end{equation}
on the same domain $x \in [0,1] := \Omega$ and $t > 0$. 
Note that we now have Dirchlet boundary conditions, 
and the analytical solution is readily available as
\begin{equation}
    u(x,t) = \sin(\pi x)  e^{- \pi^2 t}.
    % Necessary to derive this? Just sepparation of variables
\end{equation}

When doing mesh refinement of the spatial grid, 
we vary the number of spatial grid points $M$, 
and compute the numerical solution at the same point in time $t=t_{end}$. 
The number of time steps $N$ is kept fixed, 
and compute both the $L_2$ discrete relative error. 
For equation \eqref{eq:2b-manufactured} we also compute the $l_2$ continous relative error, 
and the resulting convergence plots are shown in figure \ref{fig:2a-convergence} and \ref{fig:2b-convergence}. 

Both methods are second order in the spatial step $h$, 
but Crank-Nicolson is one order higher in time step $k$. 

\begin{figure}[ht]
    \centering
    \input{exercise2/2a_UMR_discrete.pgf}
    \label{fig:2a-convergence}
\end{figure}

\begin{figure}[ht]
    \centering
    \input{exercise2/2b_UMR_combined.pgf}
    \label{fig:2b-convergence}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% TODO: AMR data is likely to change.
% Luckily, that isn't a big problem, as pgfplots is brilliant.

% Seriously. It's glorious.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%        ,,,,,             pgfplots
%       ////""\               .
%      (((/ m m              -|-                        __
%      )))c  = )              |                        (__)
%     ////-./~`    .                                    []
%    (((( `.`\    ::                                    []
%     )))`\ \)).-;.'                           .------, []
%      (() `._.-'`                           _(        )[]
%      )/ `. |  .'`^^^^^^^^^^^^^^^^^^^^^^^^^^))\`.----'`[]
%jgs   (    \' { ~ - ~~ _  ~  -  ~~  - ~  - ((  | |     []
%  .-.--\    \ {                             )) | |     []
%  |_;_._`\   |{                            ((__|_|-----[]
% |  ;   ```  ;{                             ))         []
% | /``-.____/ `~~~[]~~~~~~~~~~~~~~~~~~~~~~~'-'         []
% `'              (__)                                 (__)
%\begin{figure}[ht]
%    \centering
%    \input{exercise2/2b_AMR_combined.pgf}
%\end{figure}

\section{Invicid Burgers' equation}

In this section we briefly inspect and solve the inviscid Burgers' equation, 
and evaluate the breaking which this equation exhibits. 

Notes:
    -Also semi-discretization, but integrate using off-shelf routine
    -Breaking/shock formation: Numerical vs theoretical

\begin{figure}[ht]
    \centering
    \input{exercise2/2c_samples.pgf}
\end{figure}
