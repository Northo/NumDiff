\section{Biharmonic equation}
\label{sec:PDE}

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\theoremstyle{remark}
\newtheorem*{remark}{Remark}

\theoremstyle{definition}
\newtheorem{definition}{Definition}

Consider the inhomogeneous Biharmonic equation with clamped boundary conditions on the unit square $\Omega = [0, 1]^2$:
\begin{subequations}\label{eq:PDE}
  \begin{equation}
    \nabla^4 u = f \quad, (x, y) \in \Omega,
  \end{equation}
  \begin{equation}
    u = 0, \nabla^2u = 0 \quad, (x, y) \in \partial\Omega.
  \end{equation}
\end{subequations}

\subsection{Analytical solution}
\label{sec:pde:anal}
\begin{figure}[b!]
\centering
\pgfplotsset{colormap={redblue}{rgb=(0,0,1) rgb=(1,1,1) rgb=(1,0,0)}}
\begin{tikzpicture}
\begin{axis}[
	width=7.5cm, height=7.5cm,
	xtick={-1,0,1}, ytick={-1,0,1},
	xlabel=$x$, ylabel=$y$,
	title={$u(x,y)$},
	% grid=major,
	declare function={
		myfunc(\x,\y)=sin(deg(pi*\x))*sin(deg(pi*\y)); % + 0.5*sin(deg(3*pi*\x))*sin(deg(3*pi*\y));
	},
	colormap name=redblue,
	view={0}{90},
	% colorbar right, colorbar style={ytick={-1,0,+1}},
]
\addplot3 [surf, domain=-1:1, contour filled={number=50}] {myfunc(x,y)};
\draw (+0.5, +0.5) node {$u(x,y)$};
\draw (-0.5, +0.5) node {$-u(x+1,y)$};
\draw (+0.5, -0.5) node {$-u(x,y+1)$};
\draw (-0.5, -0.5) node {$u(x+1,y+1)$};
\draw [->, thick] (+0.1, +0.5) -- (-0.1, +0.5);
\draw [->, thick] (+0.5, +0.1) -- (+0.5, -0.1);
\draw [->, thick] (-0.5, +0.1) -- (-0.5, -0.1);
\draw [->, thick] (+0.1, -0.5) -- (-0.1, -0.5);
\end{axis}
\end{tikzpicture}
\hfill
\begin{tikzpicture}
\begin{axis}[
	width=8cm, height=8cm,
	xtick={-1,0,1}, ytick={-1,0,1},
	xlabel=$x$, ylabel=$y$, zlabel={$u(x,y)$},
	% grid=major,
	declare function={
		myfunc(\x,\y)=sin(deg(pi*\x))*sin(deg(pi*\y)); % + 0.5*sin(deg(3*pi*\x))*sin(deg(3*pi*\y));
	},
	colormap name=redblue,
	% view={0}{90},
	% colorbar right, colorbar style={ytick={-1,0,+1}},
]
\addplot3 [surf, domain=-1:1] {myfunc(x,y)};
\end{axis}
\end{tikzpicture}
\caption{\label{continuationfig}
	The function $u(x,y)$ is originally defined on $[0,1]\times[0,1]$, but we extend the definition to the full $xy$-plane with the rules $u(x+1,y) = u(x,y+1) = -u(x,y)$.
	This makes $u(x,y)$ periodic and permits Fourier analysis.
	Here is the continuation on $[-1,1]\times[-1,1]$.
}
\end{figure}

To use Fourier analysis, let us extend the definition of $u(x,y)$ on $[0,1]\times[0,1]$ to the full $xy$-plane $[-\infty,+\infty]\times[-\infty,+\infty]$ as the antisymmetric continuation with the rules $u(x,y+1) = u(x+1,y) = -u(x,y)$.
The procedure is illustrated in \cref{continuationfig}.
Using the antisymmetry, the conditions $u = -u = 0$ and $\nabla^2 u = -\nabla^2 u = 0$ are automatically satisfied at the boundaries.
This can also be seen for the simple trial function in \cref{continuationfig}, which vanishes and inflects at the boundaries.
Now $u(x,y) = u(x+2,y) = u(x,y+2)$ is periodic in both directions with period $2$ and can therefore be written as a Fourier series \cite{Kreyszig}
\begin{equation*}
	u(x,y) = \sum_{m=-\infty}^{+\infty} \sum_{n=-\infty}^{+\infty} \hat{u}_{mn} e^{i 2 \pi m x / 2} e^{i 2 \pi n y / 2}.
\end{equation*}
Multiply by $e^{i 2 \pi m' x / 2} e^{i 2 \pi n' y / 2}$, integrate over $x$ and $y$ and use orthogonality to find the coefficients
\begin{equation*}
	\hat{u}_{mn} = \frac{1}{4} \integraltwo{u(x,y) e^{-i 2 \pi m x / 2} e^{-i 2 \pi n y / 2}}{x}{y}{-1}{+1}{-1}{+1}.
\end{equation*}
By the antisymmetry $u(x+1,y)=u(x,y+1)=-u(x,y)$ and the symmetry $u(x+1,y+1)=u(x,y)$, the Fourier coefficients satisfy
\begin{equation*}
	u_{m,n} = -u_{-m,n} = -u_{m,-n} = u_{-m,-n},
\end{equation*}
so $\hat{u}_{00} = -\hat{u}_{00} = 0$ and we can write the Fourier series as
\begin{equation*}
\begin{split}
	u(x,y) &= \sum_{m=1}^{+\infty} \sum_{n=1}^{+\infty} \hat{u}_{mn}
	\left( 
	  e^{+i \pi m x} e^{+i \pi n y}
	- e^{-i \pi m x} e^{+i \pi n y}
	- e^{+i \pi m x} e^{-i \pi n y}
	+ e^{-i \pi m x} e^{-i \pi n y}
	\right) \\
	       &= -4 \sum_{m=1}^{+\infty} \sum_{n=1}^{+\infty} \hat{u}_{mn} \sin(m \pi x) \sin(n \pi y)
\end{split}
\end{equation*}
after simplifying all complex expontentials using Euler's identity $e^{ix} = \cos x + i \sin x$.
Rescaling $\hat{u}_{mn} \rightarrow -\hat{u}_{mn}/4$, we then begin by expressing our analytical solution as the double sine series
\newcommand{\fourierseries}[3]{
	\sum_{#2=1}^{\infty} \sum_{#3=1}^{\infty} #1 \sin(#2 \pi x) \sin(#3 \pi y)
}
\newcommand{\fourierexpand}[1]{
	\fourierseries{\hat{#1}_{mn}}{m}{n}
}
\begin{equation}
u(x,y) = \fourierexpand{u}.
\label{pde:equation:fourierexpansion}
\end{equation}

Plug this Fourier series into \cref{eq:PDE} and act with the biharmonic operator to get
\begin{equation*}
\nabla^4 u(x,y) = \fourierseries{\left((m\pi)^2+(n\pi)^2\right)^2 \hat{u}_{mn}}{m}{n} = f(x,y).
\end{equation*}
For simplicity, we \textbf{restrict ourselves to sources that can also be written}
\begin{equation}
	f(x,y) = \fourierexpand{f}.
\end{equation}

The Fourier series for $\nabla^4 u(x,y)$ and $f(x,y)$ can be equal only if their coefficients are equal.
This can be seen formally by multiplying both by $\sin(2m'\pi x) \sin(2n'\pi y)$, integrating over $x$ and $y$ and using orthogonality of the sine functions,
\begin{equation*}
	\integral{\sin(m\pi x) \sin(m' \pi x)}{x}{0}{1} = \frac{1}{2} \delta_{mm'}.
\end{equation*}
Therefore, the coefficients of the solution are
\begin{equation}
	\hat{u}_{mn} = \frac{\hat{f}_{mn}}{\left((m\pi)^2+(n\pi)^2\right)^2},
\end{equation}
and the solution $u(x,y)$ is available by summing its Fourier series \ref{pde:equation:fourierexpansion}.

If we know $\hat{f}_{mn}$, it is straightforward to compute $\hat{u}_{mn}$ and thus the solution $u(x,y)$ itself from its Fourier series.
If we only know $f(x,y)$, we can find the coefficients by using the orthogonality of the sine functions again.
Multiply the Fourier series by $\sin(m' \pi x) \sin(n' \pi y)$ and integrate over $x$ and $y$ to get
\begin{equation*}
\begin{split}
  & \,\, \integraltwo{f(x,y) \sin(m' \pi x) \sin(n' \pi y)}{x}{y}{0}{1}{0}{1} \\
= & \,\, \sum_{m=1}^{\infty} \sum_{n=1}^{\infty} \hat{f}_{mn} \underbrace{\integral{\sin(m\pi x)\sin(m'\pi x)}{x}{0}{1}}_{\delta_{mm'}/2} \underbrace{\integral{\sin(\pi y)\sin(n'\pi y)}{y}{0}{1}}_{\delta_{nn'}/2} \\
= & \,\, \hat{f}_{m'n'} / 4.
\end{split}
\end{equation*}
Read from bottom to top,
\begin{equation}
\hat{f}_{mn} = 4 \integraltwo{f(x,y) \sin(m \pi x) \sin(n \pi y)}{x}{y}{0}{1}{0}{1}.
\end{equation}

Note that a general source $f(x,y)$ may only be represented exactly by an infinite Fourier series.
To make the Fourier series solution viable, we must cut it off to include only a finite number of terms.
In this case, we should analyze $f(x,y)$ to make sure that we exclude only Fourier modes that contribute insignificantly to the solution.
However, we can also construct problems with a finite number of terms in the \emph{exact} solution by simply defining the source $f(x,y)$ in terms of a finite number of nonzero Fourier coefficients.

%% b)

\subsection{Numerical solution}
\label{sec:pde:numerical_solution}

We transform the Biharmonic equation \ref{eq:PDE} into a system of Poisson equations by introducing $g = \nabla^2 u$:
\begin{align}\label{eq:PDE-poisson}
  \begin{split}
    \nabla^2g &= f,\\
    \nabla^2u &= g,\\
    g = u &= 0,\quad \text{ on } \partial \Omega.
  \end{split}
\end{align}
Instead of solving the Biharmonic equation directly with a stencil for $\nabla^4$, we will solve the two Poisson equations successively with a stencil $\nabla_n^2$ for $\nabla^2$ only.
First, we solve $\nabla^2 g = f$ to obtain an intermediate numerical solution $G \approx g$.
Then we solve $\nabla^2 u = g$ to obtain the final numerical solution $U \approx u$.
In the first step we will use the exactly known source $f$, but in the second step we will only use the approximate source $G \approx g$.

%% c)
\newcommand{\crossStencilInternal}[5]{
    \draw (0,-1) node{$#1$} -- (0,+1) node{$#2$};
    \draw (-1,0) node{$#3$} -- (+1,0) node{$#4$};
	\draw (0,0)  node{$#5$};
}
\newcommand{\xStencilInternal}[4]{
    \draw (-1,-1) node{$#1$} -- (+1,+1) node{$#2$};
    \draw (-1,+1) node{$#3$} -- (+1,-1) node{$#4$};
}
\newcommand{\crossStencil}[5]{%
  \begin{tikzpicture}[scale=1.0,baseline={([yshift=-0.5ex]current bounding box.center)}, every node/.style={scale=1.0,inner sep=0pt, minimum size=5.5ex, fill=white}, nodes={draw, circle}]
    \crossStencilInternal{#1}{#2}{#3}{#4}{#5}
  \end{tikzpicture}
}
\newcommand{\xStencil}[4]{%
  \begin{tikzpicture}[scale=1.0,baseline={([yshift=-0.5ex]current bounding box.center)}, every node/.style={scale=1.0,inner sep=0pt, minimum size=5.5ex, fill=white}, nodes={draw, circle}]
    \xStencilInternal{#1}{#2}{#3}{#4}
  \end{tikzpicture}
}
\newcommand{\boxStencil}[9]{
  \begin{tikzpicture}[scale=1.0,baseline={([yshift=-0.5ex]current bounding box.center)}, every node/.style={scale=1.0,inner sep=0pt, minimum size=5.5ex, fill=white}, nodes={draw, circle}]
	\xStencilInternal{#6}{#7}{#8}{#9};
	\crossStencilInternal{#1}{#2}{#3}{#4}{#5};
  \end{tikzpicture}
}

For the Laplacian $\nabla^2$, we will use both a $5$-point stencil and a $9$-point stencil:
\begin{equation*}
	\nabla_5^2 = \crossStencil{1}{1}{1}{1}{-4}
	\qquad \text{and} \qquad
	\nabla_9^2 = \boxStencil{\frac23}{\frac23}{\frac23}{\frac23}{-\frac{10}{3}}{\frac16}{\frac16}{\frac16}{\frac16} 
	\,.
\end{equation*}
They are defined by their action on some function.
For example,
\begin{equation*}
	\nabla_5^2 u(x,y) = \frac{-4u(x,y) + u(x+h,y) + u(x-h,y) + u(x,y+h) + u(x,y-h)}{h^2},
\end{equation*}
and $\nabla_9^2$ acts similarly but also includes terms like $u(x+h, y+h)$.
We will solve Poisson equations with
\begin{equation}
	\nabla_5^2 U = F
	\qquad \text{and} \qquad
	\nabla_9^2 U = \left( 1 + \frac{1}{12} \nabla_5^2 \right) F
	.
\label{eq:pde:stencilequation}
\end{equation}
We will later show that the former is $\Oh(h^2)$, while the latter is $\Oh(h^4)$.
% It will become clear later why we also use the $\nabla_5^2$-stencil on the right side.

Next, we turn to formulating \cref{eq:pde:stencilequation} as matrix equations.
We define $U$, $G$ and $F$ as flattened vectors of the discretized functions for $u$, $g$ and $f$ following the same procedure as in \cref{sec:exc3:numerical}.
For the $5$-point stencil, first define the one-dimensional second order central finite difference matrix,
$$
J_5 =
\begin{bmatrix}
  -2 & 1 &   \\
  1 & -2 & 1 &  \\
  & 1 & -2 & 1 & \\
  &&\ddots&\ddots&\ddots\\
  &&& 1 & -2 & 1\\
  &&&& 1 & -2
\end{bmatrix}
.
$$
Using the Kroenecker product $\otimes$ and the Kroenecker sum $\oplus$, the $5$-point stencil is represented by
$$
K_5 =
\begin{bmatrix}
  J_5 & 0 & 0 & \\
  0 & J_5 & 0 & \ddots \\
  0 & 0 & J_5 & \ddots \\
  &\ddots&\ddots&\ddots
\end{bmatrix}
+
\begin{bmatrix}
  -2I & I & 0 & \\
  I & -2I & I & \ddots \\
  0 & I & -2I & \ddots  \\
  & \ddots & \ddots & \ddots & \\
\end{bmatrix}
= I \otimes J_5
+ J_5 \otimes I 
= J_5 \oplus J_5
.
$$

For the $9$-point stencil, note that it can be split into
$$
\boxStencil{\frac23}{\frac23}{\frac23}{\frac23}{-\frac{10}{3}}{\frac16}{\frac16}{\frac16}{\frac16}
\quad = \quad
\crossStencil{\frac23}{\frac23}{\frac23}{\frac23}{-\frac{10}{3}}
\quad + \quad
\xStencil{\frac16}{\frac16}{\frac16}{\frac16}
$$
The first term can be handled like the $5$-point stencil and is represented by $J_9 \oplus J_9$ with
\begin{equation*}
J_9 = 
\frac13
\begin{bmatrix}
  -5 & 2 &   \\
  2 & -5 & 2 &  \\
  & 2 & -5 & 2 & \\
  &&\ddots&\ddots&\ddots\\
  &&& 2 & -5 & 2\\
  &&&& 2 & -5
\end{bmatrix}
.
\end{equation*}
The second stencil picks out neighbours located diagonally from the center point and is represented by
\begin{equation*}
\frac{1}{\sqrt{6}}
\begin{bmatrix}
0 & \Sigma &   \\
\Sigma & 0 & \Sigma & \ddots \\
  & \Sigma & 0 & \ddots \\
& \ddots & \ddots & \ddots \\
\end{bmatrix}
= 
\Sigma \otimes \Sigma
\qquad \text{with} \qquad
\Sigma =
\frac{1}{\sqrt{6}}
\begin{bmatrix}
0 & 1  \\
1 & 0 & 1 & \ddots \\
  & 1 & 0 & \ddots \\
  & \ddots & \ddots & \ddots \\
\end{bmatrix}
.
\end{equation*}

Summarizing, the finite difference matrix equations corresponding to \ref{eq:pde:stencilequation} that we will solve are
\begin{equation}
\begin{alignedat}{2}
	K_5 U &= F
	&& \qquad \text{with} \qquad
	K_5 = J_5 \oplus J_5 \\
	K_9 U &= \left(I + \frac{h^2}{12} K_5 \right) F 
	&& \qquad \text{with} \qquad
	K_9 = J_9 \oplus J_9 + \Sigma \otimes \Sigma.
\end{alignedat}
\end{equation}

(TODO: use $U$ or $v$ for discrete approximtae solution?)

(TODO: say the matrices are toeplitz and symmetric) (TODO: Is this correct? I believe it is not Teoplitz, due to the zeros on the off diagonals), where the main diagonal has -4 and the $\pm 1$ and $\pm N$ off diagonals have 1.

(TODO: should we more clearly differentiate between the discrete function and the vector describing it?)

(TODO: Verify order (ie. not I x K + K x I) believe this is a convention thing).

(TODO: check conventions on $h^2$)

(TODO: This may also be useful when working with sparse matricies, as efficient methods for the Kronecker product are implemented in frameworks such as Scipy\cite{scipy_kron}.)

(TODO: move eigenstuff to FPS section?)

Let $\lambda_k, ~k\in[1, n]$ be the eigenvalues of the matrix $A$, and let $\mu_l, ~l\in [1, m]$ be the eigenvalues of the matrix $B$.
As shown in for example \textcite{Laub_2004}, the eigenvalues of the Kronecker product $A \otimes B$ are the products of the eigenvalues of $A$ and $B$,
$$
%% \lambda_1 \mu_1, \dots, \lambda_1 \mu_m,
%% \lambda_2 \mu_1, \dots, \lambda_2 \mu_m,
%% \dots,
%% \lambda_n \mu_1, \dots, \lambda_n \mu_m.
\lambda_k\mu_l, \quad k \in [1, n], l\in [1,m].
$$
The eigenvalues of the Kronecker sum $A\oplus B$ are the sum of the eigenvalues of $A$ and $B$
$$
%% \lambda_1 + \mu_1, \dots, \lambda_1 + \mu_m,
%% \lambda_2 + \mu_1, \dots, \lambda_2 + \mu_m,
%% \dots,
%% \lambda_n + \mu_1, \dots, \lambda_n + \mu_m.
\lambda_k + \lambda_l, \quad k \in [1, n], l\in [1,m].
$$
Moreover, if $x_1, \dots, x_n$ are linearly independent eigenvectors of $A$ corresponding to $\lambda_1, \dots, \lambda_n$, and $z_1, \dots, z_n$ are linearly independent eigenvectors of $B$ corresponding to $\mu_1, \dots, \mu_n$, then $x_k \otimes z_l$ are linearly independent eigenvectors of $A\otimes B$ corresponding to $\lambda_k \mu_l$.
%(TODO: these are non-obvious properties, need a reference, e.g. \url{http://www.siam.org/books/textbooks/OT91sample.pdf} theorem 13.12 and 13.16)
% Some properties/proofs in https://www.uio.no/studier/emner/matnat/ifi/nedlagte-emner/INF-MAT3350/h07/undervisningsmateriale/chap9slides.pdf
According to \cite{tridiagonal} the eigenvalues of a TST matrix where $a$ is the main diagonal and $b$ is the off diagonal are 
\begin{equation*}
	\lambda_k = a + 2 b \cos\left(\frac{k \pi}{N + 1}\right)
\end{equation*}
and the eigenvectors are
\begin{equation*}
  y_k(m) = \sin\frac{m k \pi}{N+1}.
\end{equation*}
Thus, $K_{2D}, \tilde{K}_{2D}^{(9)}, \text{ and } \Sigma_{2D}$ share the same eigenvectors, (TODO: consider to argue more explicitly for this)
\begin{equation}\label{eq:pde:eigenvec}
y_{kl}(m, n) = \sin\frac{m k \pi}{N+1}\sin\frac{n l \pi}{N+1}.
\end{equation}
As a result, $K_{2D}^{(9)}$ also share these eigenvectors.
%% Thus the eigenvalues of $K$ are
%% $$
%% \lambda_k = -2
%% \left(1 - \cos\left(\frac{k \pi}{N + 1}\right)\right)
%% $$
%% and the eigevalues of $\Sigma$ are
%% $$
%% \gamma_k = -\frac{2}{\sqrt{6}}\cos\left(\frac{k \pi}{N + 1}\right).
%% $$
The eigenvalues of $K_{2D}$ are then
$$
\left(-2 + 2\cos\left(\frac{k \pi}{N + 1}\right)\right)
+
\left(-2 + 2\cos\left(\frac{l \pi}{N + 1}\right)\right).
$$
The eigenvalues of $\tilde{K}_{2D}^{(9)}$ are
$$
\frac13\left(-10 + 4\cos\left(\frac{k \pi}{N + 1}\right)\right)
+
\frac13\left(-10 + 4\cos\left(\frac{l \pi}{N + 1}\right)\right)
$$
and the eigenvalues of $\Sigma_{2D}$ are
$$
\frac46
\cos\left(\frac{k \pi}{N+1}\right)
\cos\left(\frac{l \pi}{N+1}\right).
$$
The eigenvalues of the nine point stencil $K_{2D}$ are thus
\begin{equation}
  -\frac{10}{3}
  + \frac43
  \left(
  \cos(\frac{k \pi}{N+1})
  + \cos(\frac{l \pi}{N+1})
  \right)
  +
  \frac46
  \cos(\frac{k \pi}{N+1})
  \cos(\frac{l \pi}{N+1}).
\end{equation}
TODO: Consider writing all of these eigenvalues in a more structured manner.

%% Let us defne an infinity norm for convenience
\newcommand{\inorm}[1]{
\lVert #1 \rVert_\infty
}

\subsection{Stability and order of the five and nine point stencils}
\begin{definition}
  A proper $n$-point stencil $\nabla_n^2$ with weights $a_i$ has the properties
  \begin{equation*}
  	\nabla_n^2 f(x_0) = \sum_{i=0}^{n-1} a_i f(x_i),
	\qquad 
	a_i > 0 \,\, \text{for} \,\, i \geq 1
	\qquad \text{and} \qquad
	\sum_{i=1}^{n-1} a_i = -a_0,
  \end{equation*}
  where $x_i$ are the neighbouring points of $x_0$.
\end{definition}

\begin{lemma}[Discrete maximum principle]\label{pde:lemma:max}
If $\nabla_n^2 f \geq 0$ on $\Omega$ and $\nabla_n^2$ is a proper stencil, then $f$ attains its maximum value on $\partial \Omega$, that is
$$
\max_\Omega f  \leq \max_{\partial \Omega} f.
$$
\end{lemma}
\begin{proof}
Suppose instead that $\max_\Omega f > \max_{\partial \Omega} f$.
Then there is an internal grid point $x_0$ on which $f$ attains its maximum value $f(x_0) \geq f(x_i)$, where $x_i$ are the neighbouring points $x_i$.
Then
\begin{equation}
  -a_0 f(x_0)
  = \sum_{i=1}^{n-1} a_i f(x_i) - \nabla_n^2 f(x_0)
  \leq \sum_{i=1}^{n-1} a_i f(x_i)
  \leq \sum_{i=1}^{n-1} a_i f(x_0)
  = -a_0 f(x_0).
\end{equation}
The right side is equal to the left side, so equality must hold throughout and $\sum_{i=1}^{n-1} a_i (f(x_0) - f(x_i)) = 0$.
The stencil is proper, so $a_i > 0$ for $i \geq 1$ and all the are nonnegative, so it can only vanish if $f(x_0) = f(x_1) = \dots = f(x_{n-1})$.
Repeating the argument at each neighbour $x_i$, and then to their neighbours and so on, we ultimately reach the conclusion that the same value is also attained on $\partial \Omega$, so we have a contradiction.
\end{proof}

\begin{lemma}\label{pde:lemma:bound}
  If there exists a function $\phi_n(x,y) \geq 0$ such that $\nabla_n^2 \phi_n = 1$ on $\Omega$ for a proper stencil $\nabla_n^2$, and $v$ is a discrete function that equals zero on $\partial \Omega$, then
  \begin{equation}
    \inorm{v} \leq \max_{\partial\Omega} \lvert \phi_n \rvert
    \inorm{\nabla_n^2 v}.
  \end{equation}
\end{lemma}
\begin{proof}

Let $\inorm{\nabla_n^2 v} = M$.
Then
$$
\nabla_n^2 (v + \phi_n M) = \nabla_n^2 v +  M \geq 0.
$$
Since $\nabla_n^2$ is a proper stencil, $v + \phi_n M$ attains its maximum value on $\partial \Omega$ by lemma \ref{pde:lemma:max}.
Thus
$$
\inorm{v}
\leq \inorm{v + \phi_n M}
\leq \max_{\partial \Omega} \lvert v + \phi_n M\rvert
= \max_{\partial\Omega} \lvert \phi_n \rvert M
= \max_{\partial\Omega} \lvert \phi_n \rvert \inorm{\nabla_n^2 v}. \qedhere
$$
\end{proof}

\begin{remark}
  For the five and nine point stencil, such functions do exist.
  Suspecting that the stencils are second and fourth order, we look for second and fourth order polynomials in $x$ and $y$ with this property.
  We find 
  \begin{equation}
    \phi_5(x,y) = \frac14 \left(\left(x-\frac12\right)^2 + \left(y-\frac12\right)^2\right)
    \label{pde:equation:phi5}
  \end{equation}
  with the property $\nabla_5^2 \phi_5(x,y) = 1$, taking the values $0 \leq \phi_5(x,y) \leq 1/8$ on $\Omega$ and attaining the maximum on $\partial \Omega$.
  \newcommand{\phinine}{\frac{1}{5} \left(\left(x-\frac{1}{2}\right)^4+\left(y-\frac{1}{2}\right)^4\right) - \frac{6}{5} \left(x-\frac{1}{2}\right)^2\left(y-\frac{1}{2}\right)^2 + \frac{1}{4} \left(\left(x-\frac{1}{2}\right)^2+\left(y-\frac{1}{2}\right)^2\right)}
  Similarly, the polynomial
  \begin{equation}
  \phi_9(x,y) = \phinine
  \label{pde:equation:phi9}
  \end{equation}
  is such that $\nabla_9^2 \phi_9(x,y) = 1$, takes the values $0 \leq \phi_9(x,y) \leq 3/40$ on $\Omega$ and attains the maximum on $\partial \Omega$.
  Both are shown in \cref{pde:figure:phi}.
\end{remark}

\newcommand{\phidisplay}[3]{
\begin{tikzpicture}
\begin{axis}[
	width=8.2cm, height=7.5cm,
	zmin=0.0,zmax=0.13,
	xlabel=$x$, xtick distance=0.25,
	ylabel=$y$, ytick distance=0.25,
	ztick={0,#2, 1/8}, zticklabels={0,#2, 1/8},
	scaled ticks=false,
	grid,
	title={$#3$},
  point meta max=0.13,  % Sets max value for cmap 
]
	\addplot3 [
		surf,
		domain=0:1,
	] {#1};
\end{axis}
\end{tikzpicture}
}

\begin{figure}[t]
\centering
\phidisplay{1/4*((x-1/2)^2+(y-1/2)^2)}{-1}{\phi_5(x,y)}
\phidisplay{1/5*((x-1/2)^4+(y-1/2)^4)-6/5*(x-1/2)^2*(y-1/2)^2+1/4*((x-1/2)^2+(y-1/2)^2)}{3/40}{\phi_9(x,y)}
\caption{\label{pde:figure:phi}The functions $\phi_5(x,y)$ and $\phi_9(x,y)$ range from $\phi_5(\frac12,\frac12)=\phi_9(\frac12,\frac12)=0$ at the center to $\phi_5(0,0) = 1/8$ and $\phi_9(0,0)=3/40$ at the boundaries of $[0,1]\times[0,1]$.}
\end{figure}

%% 3
\begin{definition}
  We denote the maximum of all $n$-index derivatives of $u$ on $\Omega$ by
  \begin{equation*}
  \abs{D^n u}_\infty = \max_{m=0}^n \inorm{\partial_x^m \partial_y^{n-m} u}
  \end{equation*}
\end{definition}

Taylor's theorem in 2D:
\begin{equation*}
\begin{split}
	u(x+h,y+k) &= \sum_{m=0}^n \frac{1}{m!} \left( h \partial_x + k \partial_y \right)^m u(x,y) + \frac{1}{(m+1)!} u(x + \theta h, y + \eta k) \\
	u(x+h,y+k) &= \sum_{m=0}^n \frac{1}{m!} D^m u(x,y) + \frac{1}{(m+1)!} u(x + \theta h, y + \eta k)
\end{split}
\end{equation*}

\begin{theorem}[Five point stencil stability]\label{thm:five}
If $\nabla^2 u = f$ and $\nabla_5^2 v = f$ and $u = v$ on $\partial \Omega$, then
$$
\inorm{u - v} \leq C h^2 \abs{D^4 v}_\infty.
$$
\end{theorem}
\begin{proof}
By lemma \ref{pde:lemma:bound} with $\phi_5(x,y)$ from \ref{pde:equation:phi5},
$$
\inorm{u - v} \leq \frac18 \inorm{\nabla_5^2 (u  - v)}.
$$
Taylor expand all terms in $\nabla_5^2 u$ around $(x,y)$ to first order to get
\begin{equation}
\begin{split}
  \nabla_5^2 u(x,y)
  &=    \nabla^2 u(x,y) + \frac{h^2}{12} (\partial_x^4 + \partial_y^4) u(x + \theta h, y + \eta h) \qquad \qquad (0 \leq \theta, \eta \leq 1)  \\
  &\leq f(x,y)          + C_1 h^2 \abs{D^4 u}_\infty.
\end{split}
\label{eq:pde:taylornabla2}
\end{equation}
Finally, substitute $f = \nabla_5^2 v$ to conclude that
\begin{equation*}
  \inorm{u - v}
  \leq \frac18 \inorm{\nabla_5^2 (u  - v)}
  \leq C h^2 \abs{D^4 u}_\infty. \qedhere
\end{equation*}
\end{proof}


%% 3
\begin{theorem}[Nine point stencil stability]\label{thm:nine}
If $\nabla^2 u = f$ and $\nabla_9^2 v = f + \frac{1}{12} \nabla_5^2 f$ and $u = v$ on $\partial \Omega$, then
$$
\inorm{u - v} \leq C h^4 \lvert D^6 v\rvert_\infty.
$$
\end{theorem}
\begin{proof}
By lemma \ref{pde:lemma:bound} with $\phi_9$ from \ref{pde:equation:phi9},
$$
\inorm{u - v} \leq \frac{3}{40} \inorm{\nabla_9^2 (u  - v)}.
$$
Taylor expand all terms in $\nabla_9^2 u$ around $(x,y)$ as in the former proof to get
\begin{align*}
  \nabla_9^2 u(x,y) &= \nabla^2 u(x,y) + \frac{h^2}{12} \nabla^4 u(x,y) + \frac{h^4}{360} \left( \partial_x^6 + \partial_y^6 + 5 \partial_x^2 \partial_y^4 + 5 \partial_x^4 \partial_y^2 \right) u(x + \theta h,y + \eta h) \qquad (0 \leq \theta, \eta \leq 1) \\
                    &\leq f(x,y)       + \frac{h^2}{12} \nabla^2 f(x,y) + C_1 h^4 \abs{D^6 u}_\infty.
\end{align*}
From \cref{eq:pde:taylornabla2} with $u \rightarrow f$, we also know that
\begin{align*}
	\nabla^2 f(x,y) &\leq \nabla_5^2 f(x,y) + C_2 h^2 \abs{D^4 f}_\infty \\
	                &\leq \nabla_5^2 f(x,y) + C_3 h^2 \abs{D^6 u}_\infty.
\end{align*}
Altogether,
\begin{equation*}
	\nabla_9^2 u(x,y) \leq f(x,y) + \frac{h^2}{12} \nabla_5^2 f(x,y) + C_4 h^4 \abs{D^6 u}_\infty.
\end{equation*}
Finally, substitute $f + \frac{h^2}{12} \nabla_5^2 f = \nabla_9^2 v$ to conclude that
\begin{equation*}
  \inorm{u-v} \leq \frac{3}{40} \inorm{\nabla_9^2 (u - v)} \leq C h^4 \abs{D^6 u}_\infty. \qedhere
\end{equation*}
\end{proof}

We have just shown that as $h \rightarrow 0$, the truncation error $\nabla_n^2 (u - v) \rightarrow 0$ and global error $\Vert u - v \Vert \rightarrow 0$, so the schemes are consistent and convergent.
By Lax' equivalence theorem \cite{owren}, they are then also stable.

\subsubsection{Stability when solving the Biharmonic equation}
Theorems \ref{thm:five} and \ref{thm:nine} shows that the solutions to the Poisson equation using the five and nine point stencils are stable and of order 2 and 4 respectively.
We will here show that the order of the solution to the system of Poisson equations in \eqref{eq:PDE-poisson} will be of the same order.

We will begin with the five point stencil.
One must show that
$$
\inorm{U - u} \leq Ch^2,
$$
where $u$ is the exact solution $\nabla^4 u = f$.
Solving the Biharmonic equation as a system of Poisson equations consists of two steps 1) $\nabla^2 g = f$ and 2) $\nabla^2 u = g$.
We find an approximation $G$ to $g$, where by theroem \ref{thm:five}
$$
\inorm{G - g} \leq C h^2.
$$
When solving step 2) we would ideally solve
$$
\nabla_5^2 U_e = g,
$$
in which case theorem \ref{thm:five} implies that
$$
\inorm{U_e - u} \leq C h^2.
$$
However we end up solving
$$
\nabla_5^2 U = G = g + \gamma(x, y) h^2.
$$
We have that
\begin{equation}
  \nabla_5^2 (U - U_e) = \gamma(x, y) h^2,
\end{equation}
By lemma \ref{pde:lemma:bound}
$$
\inorm{U - U_e} \leq \frac18 \inorm{\nabla_5^2 (U - U_e)} = \frac18 \inorm{\gamma(x, y) h^2} \leq C h^2.
$$
Thus,
\begin{align*}
  \inorm{U - u} &= \inorm{U - U_e + U_e - u}\\
  &\leq \inorm{U - U_e} + \inorm{U_e - u}\\
  &\leq C h^2.
\end{align*}


\subsection{The Fast Poisson Solver}
The procedure for the Fast Poisson Solver is based on the explanation in \cite{Strang_2012}.\\

We are to solve the equation
$$
A U = F.
$$
Assuming that the eigenvectors of $A$ form a complete set, we may write
$$
F = a_1 y_1 + a_2 y_2 + ...,
$$
where $y_1, y_2, \dots$ are the eigenvectors of $A$.
A similar expansion must exist for $U$, as the eigenvectors are assumed to be complete.
One may verify simply by insertion that the solution $U$ is then of course
$$
U =
\frac{a_1}{\lambda_1} y_1
+ \frac{a_2}{\lambda_2} y_2
+ \dots,
$$
where $\lambda_i$ is the eigenvalue corresponding to $y_i$.
In general, however, this is not a viable way to solve the problem, as it requires knowing all the eigenvalues and eigenvectors, as well as finding the coefficients $a_i$.
However, for the set of eigenvectors in this problem, which are sines, we have a very efficient algorithm for computing the coefficients, the discrete fast sine transform.
We also have simple analytical expressions for the eigenvalues.
The idea behind the Fast Poisson Solver is to given $F$ find its expansion coefficients $a_i$, divide these by the corresponding eigenvalues $\lambda_i$, and then use this to express $U$.

According to \eqref{eq:pde:eigenvec} the $(m, n)$ compontent of the eigenvector corresponding to $\lambda_{k,l}$ is
$$
\sin\left( \frac{m k \pi}{N + 1} \right)
\sin\left( \frac{n l \pi}{N + 1} \right).
$$
The Discrete Sine Transform of type I $x(k)$ of $y(n)$ is defined through\footnote{Most literature uses a convention where $n\in[0, N-1]~ k\in[0, N-1]$. We have altered it here to comply with the rest of the report.} \cite{scipy_dst}
\begin{equation}
  y(n) =
  \sum_{k=1}^{N}
  x(k)
  \sin\left(
  \frac{
    \pi k n
  }{
    N + 1
  }
  \right), ~ n = 1, \dots N.
\end{equation}
%% Given a discrete function $y_k$, the discrete sine transform (of type I) in one dimension, $x[n]$, is defined as\cite{scipy_dst} (TODO: figure out prefactors)
%% $$
%% y_k =
%% 2 \sum_{n=0}^{N-1}
%% x[n]
%% \sin\left(
%% \frac{
%%   \pi (k+1) (n+1)
%% }{
%%   N + 1
%% }
%% \right), ~0 \leq k < N.
%% $$
The two dimensional equivalent is simply to apply this transformation to the two directions sequentially.
\begin{equation}
  y(m, n) =
  \sum_{k=1}^{N}
  \sum_{l=1}^{N}
  x(k, l)
  \sin\left(
  \frac{
    \pi k m
  }{
    N + 1
  }
  \right)
  \sin\left(
  \frac{
    \pi l n
  }{
    N + 1
  }
  \right), ~ m = 1, \dots N, n = 1, \dots N.
\end{equation}
This prefectly corresonds to the eigenvector expansion of the stencils!
Therefore given $F(m, n)$ the 2D Discrete Sine Transform gives $x(k, l)$, corresponding to the coefficents $a_i$ introduced above (where now the subscript has two indices instead of one).
As we know the eigenvalues $\lambda_{k,l}$ of the five and nine point stencils from section \ref{sec:pde:numerical_solution}, the solution $U$ is readily computed by the inverse Discrete Sine Transform, which calculates $y(m, n)$ given $x(k, l)$.

Formulating the Fast Poisson Solver more directly with regards to implementing the solver, we have that the solution is
$$
U = \text{IFST}(\text{FST}(F) / \Lambda),
$$
where $\text{IFST}, \text{FST}$ are the inverse and normal Fast Sine Tranform in two dimensions, and $\Lambda$ are the eigenvalues of the stencil for which we solve.
These eigenvalues were given in section \ref{sec:pde:numerical_solution}.


%% Written as matrix expressions
%% (TODO: this could probably be removed?)
%% \begin{align*}
%%   A U &= F\\
%%   S\Lambda S U &= F\\
%%   &\Rightarrow\\
%%   U &= S\Lambda^{-1} S F,
%% \end{align*}
%% where we used the fact that $S^{-1} = S$. TODO: Justify


\subsection{Demonstration of order}
To demonstrate the order of the five and nine point stencils, we will perform UMR on the Poisson equation, with the inhomogenity $f = \sin(m \pi x)\sin(n \pi y), ~m=3, n=4$.
From section \ref{sec:pde:anal} we know that the solution to this manufactured problem is
$$
u(x, y) =
\frac{
  \sin(m \pi x)\sin(n \pi y)
}{
  (n\pi)^2 + (m\pi)^2
}
, ~m=3, n=4.
$$
The mesh refinement is done with the same number of discretization points in $x$- and $y$-direction.
The values used are $N = N_x = N_y = \{8, 16, 32, 64, 128, 256\}$.
The solution is shown in figure \ref{fig:pde:order_solution}.
The relative error as a function of $N$ is shown in figure \ref{fig:pde:order}.
As expected, the error for the five point stencil goes as $h^2$ while the error for the nine point stencil goes as $h^4$.


\begin{figure}[tb]
  \centering
  \begin{subfigure}[t]{0.49\textwidth}
    \begin{tikzpicture}
      \pgfplotsset{colormap={redblue}{rgb=(0,0,1) rgb=(1,1,1) rgb=(1,0,0)}}
      \begin{axis}[
	        % width=8.2cm, height=7.5cm,
          width=7cm, height=6cm,
          %	zmin=0.0,zmax=0.13,
	        xlabel=$x$, xtick distance=0.25,
	        ylabel=$y$, ytick distance=0.25,
          samples=50,
          %	ztick={0,#2, 1/8}, zticklabels={0,#2, 1/8},
          %	scaled taicks=false,
          grid,
	        % title={Test},
          zlabel={$u(x, y)$},
          colormap name=redblue,
	        view={20}{50},
        ]
	      \addplot3 [
		      surf,
		      domain=0:1,
          opacity=0.85,%shader=interp,
	      ] {sin(deg(3 * pi * x)) * sin(deg(4 * pi * y)) / pi^2 * (3^2 + 4^2)};
      \end{axis}
    \end{tikzpicture}
    \caption{The analytical solution $u(x, y)$.}
    \label{fig:pde:order_solution}
  \end{subfigure}
  ~
  \begin{subfigure}[t]{0.49\textwidth}

    \centering \input{./PDE/order.pgf}
    \caption{Relative error.
      Also shown are $Ch^2$ and $Ch^4$, which are the expected convergence rates of the five and nine point stencil respectively.
      The constants are chosen such that the $h^2$ and $h^4$ line appears close to the stencil errors.
      First axis shows degrees of freedom $N^2$, where $N$ is the number of internal discretization points in one direction.
    }
    \label{fig:pde:order}
  \end{subfigure}
  \caption{Solving the Poisson equation on the manufactured problem problem $f=\sin(m \pi x)\sin(n\pi y), ~m = 3, n=4$, with analytical solution $u(x, y) = \sin(m \pi x)\sin(n \pi y) / ((n\pi)^2 + (m\pi)^2)$.
    Solved with equal number of discretization points in $x$ and $y$ direction.
    Subfigure \subref{fig:pde:order_solution} shows the analytical solution $u$, while \subref{fig:pde:order} shows the relative error for the five and nine point stencil.
  }
\end{figure}


\subsection{Solving the Biharmonic equation}
\label{sec:pde:solving}
We will now solve \eqref{eq:PDE} numerically on a manufactured problem.
Let
$$
u(x, y) =
\left(
\sin \pi x
\sin \pi y
\right)^4
e^{-(x-0.5)^2 - (y-0.5)^2}.
$$
The inhomogenity $f$ is simply found by calculating $\nabla^4 u$.
The result, which was found using a computer algebra system, is somewhat lengthy, and therefore only included as an appendix for the sake of readability.



According to equation \eqref{eq:PDE-poisson} we split the equation into a system of poisson equations by introducing a new function $g$:
\begin{align*}
  \begin{split}
    \nabla^2g &= f,\\
    \nabla^2u &= g,\\
    g = u &= 0,\quad \text{ on } \partial \Omega.
  \end{split}
\end{align*}
It is now simply a matter of applying the described Fast Poisson Solver sequentially for the two equations.

The numerical solution is shown in figure \ref{fig:pde:bvp}.
In figure \ref{fig:pde:bvp_convergence} a convergence plot as a function of the degrees of freedom is shown, and the computation time is shown in figure \ref{fig:pde:bvp_time}.
We were able to solve the equation with a maximal discretization of $N = 3000$ in one direction, so about \num{1e7} grid points.


\newcommand{\biharmshowsol}[1]{
  \begin{tikzpicture}
    \pgfplotsset{colormap={redblue}{rgb=(0,0,1) rgb=(1,1,1) rgb=(1,0,0)}}
    \begin{axis}[
	      width=8.2cm, height=7.5cm,
        %	zmin=0.0,zmax=0.13,
	      xlabel=$x$, xtick distance=0.25,
	      ylabel=$y$, ytick distance=0.25,
 %       samples=50,
        %	ztick={0,#2, 1/8}, zticklabels={0,#2, 1/8},
        %	scaled taicks=false,
        %	grid,
	      % title={Test},
        zlabel={$u(x, y)$},
        mesh/ordering=x varies,
        mesh/cols=#1,
        mesh/rows=#1,
%        colormap name=redblue,
	      view={20}{50},
      ]
	    \addplot3 [
		    surf,
        point meta=explicit,
	    ] table[meta=U]{./PDE/biharmonic_solution_#1.dat};
    \end{axis}
  \end{tikzpicture}
}

\begin{figure}[tb]
  \centering
  \biharmshowsol{32} % compiles with pdflatex
  %\biharmshowsol{64} % compiles with lualatex
  \caption{The solution $u(x, y)$ to the Biharmonic equation. TODO:write more}
  \label{fig:pde:bvp}
\end{figure}

%% Error plot
\begin{figure}[hbp]
  \centering
  \begin{subfigure}[t]{0.49\textwidth}
    \begin{tikzpicture}
      \begin{loglogaxis}[
          title={},
          xlabel={$\text{DoF} = N^2$},
          ylabel={Relative error, $\lVert u - v \rVert_2 / \lVert u \rVert_2$},
          legend pos=south west,
          xmin=6^2, xmax=10e6,%2400^2,
        ]
        \addplot table[x expr=\thisrow{N}^2, y={error}] {PDE/error_bvp_rel_2.dat};
        \addlegendentry{Nine point};
        \addplot[black, dashed, domain = 6^2:2600^2, samples=2] {30/(sqrt(x)-1)^2}
        node[pos=0.3,
          pin={[pin edge={solid, out=75, in=-100}]above right:$\mathcal{O}(h^2)$},
        ] {};
      \end{loglogaxis}
    \end{tikzpicture}
    \caption{
      The relative error of the numerical solution.
      TODO: Could add five point for comparison?}
    \label{fig:pde:bvp_convergence}
  \end{subfigure}
  ~
  %% Computation time plot
  \begin{subfigure}[t]{0.49\textwidth}
    \centering
    \begin{tikzpicture}
      \begin{loglogaxis}[
          title={},
          xlabel={$\text{DoF} = N^2$},
          ylabel={Computation time [s]},
          legend pos=north west,
        ]
        \addplot table[x expr=\thisrow{N}^2, y={comp_time}] {PDE/comp_bvp_no_fps.dat};
        \addlegendentry{Scipy Sparse Solver};
        \addplot table[x expr=\thisrow{N}^2, y={comp_time}] {PDE/comp_bvp_fps.dat};
        \addlegendentry{Fast Poisson Solver};

        \addplot[domain=10^2:10^6] {1e-6 * x^(3/2)};
        \addplot[domain=10^2:10^6, dashed] {1e-8 * x * ln(x)};
        \addplot[domain=10^2:10^6, dashdotted] {1e-8 * x};

        %% \addplot[domain=8:256] {0.0001 * x * ln(x)};
        %% \addplot[domain=8:256] {0.0001 * x^2};
      \end{loglogaxis}
    \end{tikzpicture}
    \caption{
      Computation time.
      Computation times for two solvers shown, the Scipy Sparse Solver\cite{scipy_sparse_linalg_spsolve} and our own Fast Poisson Solver.
    }
    \label{fig:pde:bvp_time}
  \end{subfigure}
  \caption{Error and computation time solving the clamped Biharmonic equation on the manufactured problem with analytical solution
    $\left(
    \sin \pi x
    \sin \pi y
    \right)^4
    e^{-(x-0.5)^2 - (y-0.5)^2}$.
    Figure \subref{fig:pde:bvp_convergence} shows the relative error using the nine point stencil, while figure \subref{fig:pde:bvp_time} shows the computation time.
    Both are plottet with degrees of freedom on the first axis, the total number of internal points $N^2$.
  }
\end{figure}


%% For creating convergence plots and to use as a test on the validity of our approach, we will also find the analytical solution to the equation.
%% The function $f$ fulfills $f(x,y) = 0$ for $(x,y)\in \partial\Omega$, and we may thus use the analytical results derived in section \ref{sec:pde:anal}.
%% Fourier transforming $f$ results in 
%% \begin{equation*}
%% 	\hat{f}_{mn} =
%% 	\left[ 2 \integral{\sin^4(\pi x) \sin(m \pi x) e^{-(x-1/2)^2}}{x}{0}{1}\right]
%% 	\left[ 2 \integral{\sin^4(\pi y) \sin(n \pi y) e^{-(y-1/2)^2}}{y}{0}{1}\right].
%% \end{equation*}
%% The integrals do have analytical solutions, but they are not easy to compute.
%% We have computed them with the SAGE CAS suite.
%% Below is an easy-to-copy expression for the first bracket $ = I(m)$ in the equation above.
%% Then $\hat{f}_{mn} = I(m) \, I(n)$.
%% %% Old wrong result
%% %% >>> I(m) = 48*(pi^9*m^5*e^2 - 20*(pi^9*e^2 + 2*pi^7*e^2)*m^3 - (pi^9*m^5 - 20*(pi^9 + 2*pi^7)*m^3 + 16*(4*pi^9 + 15*pi^7 + 5*pi^5)*m)*(-1)^m + 16*(4*pi^9*e^2 + 15*pi^7*e^2 + 5*pi^5*e^2)*m)/(pi^10*m^10*e^3 - 20*(2*pi^10*e^3 - pi^8*e^3)*m^8 + 16384*pi^8*e^3 + 16*(33*pi^10*e^3 - 20*pi^8*e^3 + 10*pi^6*e^3)*m^6 + 40960*pi^6*e^3 - 320*(8*pi^10*e^3 - 7*pi^8*e^3 - 2*pi^4*e^3)*m^4 + 33792*pi^4*e^3 + 256*(16*pi^10*e^3 + 35*pi^6*e^3 + 20*pi^4*e^3 + 5*pi^2*e^3)*m^2 + 10240*pi^2*e^3 + 1024*e^3)
%% \begin{lstlisting}
%% I(m) = 2 * integral(sin(pi*x)^4*sin(m*pi*x)*exp(-(x-1/2)^2), x, 0, 1)
%% >> 1/16*sqrt(pi)*(erf(-2*I*pi + 1/2*I*pi*m + 1/2)*e^(4*pi^2*m)*sin(1/2*pi*m) - erf(-2*I*pi + 1/2*I*pi*m - 1/2)*e^(4*pi^2*m)*sin(1/2*pi*m) + 4*erf(-I*pi + 1/2*I*pi*m + 1/2)*e^(3*pi^2*m + 3*pi^2)*sin(1/2*pi*m) - 4*erf(-I*pi + 1/2*I*pi*m - 1/2)*e^(3*pi^2*m + 3*pi^2)*sin(1/2*pi*m) + 6*erf(1/2*I*pi*m + 1/2)*e^(2*pi^2*m + 4*pi^2)*sin(1/2*pi*m) - 6*erf(1/2*I*pi*m - 1/2)*e^(2*pi^2*m + 4*pi^2)*sin(1/2*pi*m) + 4*erf(I*pi + 1/2*I*pi*m + 1/2)*e^(pi^2*m + 3*pi^2)*sin(1/2*pi*m) - 4*erf(I*pi + 1/2*I*pi*m - 1/2)*e^(pi^2*m + 3*pi^2)*sin(1/2*pi*m) + erf(2*I*pi + 1/2*I*pi*m + 1/2)*sin(1/2*pi*m) - erf(2*I*pi + 1/2*I*pi*m - 1/2)*sin(1/2*pi*m))*e^(-1/4*pi^2*m^2 - 2*pi^2*m - 4*pi^2)

%% Funnet f etter ny endring:
%% 4*(6*pi^4*e^(x + y)*sin(pi*x)^4 - 8*(4*pi*y^3*e^x*sin(pi*x)^4 - 6*pi*y^2*e^x*sin(pi*x)^4 - 6*pi^3*e^x*sin(pi*x)^2 + 4*(2*pi^2*x - pi^2)*cos(pi*x)*e^x*sin(pi*x)^3 + (3*pi + 16*pi^3 - 2*pi*x^2 + 2*pi*x)*e^x*sin(pi*x)^4 + 4*(3*pi^3*e^x*sin(pi*x)^2 - 2*(2*pi^2*x - pi^2)*cos(pi*x)*e^x*sin(pi*x)^3 - (pi + 8*pi^3 - pi*x^2 + pi*x)*e^x*sin(pi*x)^4)*y)*cos(pi*y)*e^y*sin(pi*y)^3 + (4*y^4*e^x*sin(pi*x)^4 - 8*y^3*e^x*sin(pi*x)^4 - 8*(3*pi + 4*pi*x^3 + 16*pi^3 - 6*pi*x^2 - 4*(pi + 8*pi^3)*x)*cos(pi*x)*e^x*sin(pi*x)^3 + (256*pi^4 + 4*x^4 - 8*(16*pi^2 + 1)*x^2 - 8*x^3 + 64*pi^2 + 4*(32*pi^2 + 3)*x + 1)*e^x*sin(pi*x)^4 + 6*pi^4*e^x - 24*(2*pi^3*x - pi^3)*cos(pi*x)*e^x*sin(pi*x) - 12*(13*pi^4 - 6*pi^2*x^2 + 6*pi^2*x + 2*pi^2)*e^x*sin(pi*x)^2 + 8*(2*(pi - 2*pi*x)*cos(pi*x)*e^x*sin(pi*x)^3 - (16*pi^2 - x^2 + x + 1)*e^x*sin(pi*x)^4 + 3*pi^2*e^x*sin(pi*x)^2)*y^2 - 4*(4*(pi - 2*pi*x)*cos(pi*x)*e^x*sin(pi*x)^3 - (32*pi^2 - 2*x^2 + 2*x + 3)*e^x*sin(pi*x)^4 + 6*pi^2*e^x*sin(pi*x)^2)*y)*e^y*sin(pi*y)^4 - 24*(2*pi^3*y*e^x*sin(pi*x)^4 - pi^3*e^x*sin(pi*x)^4)*cos(pi*y)*e^y*sin(pi*y) + 12*(6*pi^2*y^2*e^x*sin(pi*x)^4 - 6*pi^2*y*e^x*sin(pi*x)^4 + 6*pi^4*e^x*sin(pi*x)^2 - 4*(2*pi^3*x - pi^3)*cos(pi*x)*e^x*sin(pi*x)^3 - (13*pi^4 - 2*pi^2*x^2 + 2*pi^2*x + 2*pi^2)*e^x*sin(pi*x)^4)*e^y*sin(pi*y)^2)*e^(-x^2 - y^2 - 1/2)
%% \end{lstlisting}
%% Something something sine transform.




%% \begin{figure}
%% \begin{tikzpicture}
%% \begin{axis}[
%% 	xmin=0, xmax=27,
%% 	declare function={
%% 		myfunc(\m)=48*(pi^9*(\m)^5*e^2 - 20*(pi^9*e^2 + 2*pi^7*e^2)*(\m)^3 - (pi^9*(\m)^5 - 20*(pi^9 + 2*pi^7)*(\m)^3 + 16*(4*pi^9 + 15*pi^7 + 5*pi^5)*(\m))*(-1)^(\m) + 16*(4*pi^9*e^2 + 15*pi^7*e^2 + 5*pi^5*e^2)*(\m))/(pi^10*(\m)^10*e^3 - 20*(2*pi^10*e^3 - pi^8*e^3)*(\m)^8 + 16384*pi^8*e^3 + 16*(33*pi^10*e^3 - 20*pi^8*e^3 + 10*pi^6*e^3)*(\m)^6 + 40960*pi^6*e^3 - 320*(8*pi^10*e^3 - 7*pi^8*e^3 - 2*pi^4*e^3)*(\m)^4 + 33792*pi^4*e^3 + 256*(16*pi^10*e^3 + 35*pi^6*e^3 + 20*pi^4*e^3 + 5*pi^2*e^3)*(\m)^2 + 10240*pi^2*e^3 + 1024*e^3);
%% 	},
%% 	xtick={1,6,...,26},
%% 	minor x tick num=4,
%% 	xlabel=$m$, title={$I(m)$},
%% ]
%% \addplot [domain=1:26, samples=26, mark=*] {myfunc(x)};
%% \addplot [domain=0:27, samples=2, dashed] {0};
%% \end{axis}
%% \end{tikzpicture}
%% \end{figure}

