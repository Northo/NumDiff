\section{Biharmonic equation}
\label{sec:PDE}

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\theoremstyle{remark}
\newtheorem*{remark}{Remark}

\theoremstyle{definition}
\newtheorem{definition}{Definition}

Consider the inhomogeneous Biharmonic equation with clamped boundary conditions on the unit square $\Omega = [0, 1]^2$:
\begin{subequations}\label{eq:PDE}
  \begin{equation}
    \nabla^4 u = f \quad, (x, y) \in \Omega,
  \end{equation}
  \begin{equation}
    u = 0, \nabla^2u = 0 \quad, (x, y) \in \partial\Omega.
  \end{equation}
\end{subequations}

\subsection{Analytical solution}

\begin{figure}
\centering
\pgfplotsset{colormap={redblue}{rgb=(0,0,1) rgb=(1,1,1) rgb=(1,0,0)}}
\begin{tikzpicture}
\begin{axis}[
	width=7.5cm, height=7.5cm,
	xtick={-1,0,1}, ytick={-1,0,1},
	xlabel=$x$, ylabel=$y$,
	title={$u(x,y)$},
	% grid=major,
	declare function={
		myfunc(\x,\y)=sin(deg(pi*\x))*sin(deg(pi*\y)); % + 0.5*sin(deg(3*pi*\x))*sin(deg(3*pi*\y));
	},
	colormap name=redblue,
	view={0}{90},
	% colorbar right, colorbar style={ytick={-1,0,+1}},
]
\addplot3 [surf, domain=-1:1, contour filled={number=50}] {myfunc(x,y)};
\draw (+0.5, +0.5) node {$u(x,y)$};
\draw (-0.5, +0.5) node {$-u(x+1,y)$};
\draw (+0.5, -0.5) node {$-u(x,y+1)$};
\draw (-0.5, -0.5) node {$u(x+1,y+1)$};
\draw [->, thick] (+0.1, +0.5) -- (-0.1, +0.5);
\draw [->, thick] (+0.5, +0.1) -- (+0.5, -0.1);
\draw [->, thick] (-0.5, +0.1) -- (-0.5, -0.1);
\draw [->, thick] (+0.1, -0.5) -- (-0.1, -0.5);
\end{axis}
\end{tikzpicture}
\hfill
\begin{tikzpicture}
\begin{axis}[
	width=8cm, height=8cm,
	xtick={-1,0,1}, ytick={-1,0,1},
	xlabel=$x$, ylabel=$y$, zlabel={$u(x,y)$},
	% grid=major,
	declare function={
		myfunc(\x,\y)=sin(deg(pi*\x))*sin(deg(pi*\y)); % + 0.5*sin(deg(3*pi*\x))*sin(deg(3*pi*\y));
	},
	colormap name=redblue,
	% view={0}{90},
	% colorbar right, colorbar style={ytick={-1,0,+1}},
]
\addplot3 [surf, domain=-1:1] {myfunc(x,y)};
\end{axis}
\end{tikzpicture}
\caption{\label{continuationfig}
	The function $u(x,y)$ is originally defined on $[0,1]\times[0,1]$, but we extend the definition to the full $xy$-plane with the rules $u(x+1,y) = u(x,y+1) = -u(x,y)$.
	This makes $u(x,y)$ periodic and permits Fourier analysis.
	Here is the continuation on $[-1,1]\times[-1,1]$.
}
\end{figure}

To use Fourier analysis, let us extend the definition of $u(x,y)$ on $[0,1]\times[0,1]$ to the full $xy$-plane $[-\infty,+\infty]\times[-\infty,+\infty]$ as the antisymmetric continuation with the rules $u(x,y+1) = u(x+1,y) = -u(x,y)$.
The procedure is illustrated in \cref{continuationfig}.
Using the antisymmetry, the conditions $u = -u = 0$ and $\nabla^2 u = -\nabla^2 u = 0$ are automatically satisfied at the boundaries.
This can also be seen for the simple trial function in \cref{continuationfig}, which vanishes and inflects at the boundaries.
Now $u(x,y) = u(x+2,y) = u(x,y+2)$ is periodic in both directions with period $2$ and can therefore be written as a Fourier series
\begin{equation*}
	u(x,y) = \sum_{m=-\infty}^{+\infty} \sum_{n=-\infty}^{+\infty} \hat{u}_{mn} e^{i 2 \pi m x / 2} e^{i 2 \pi n y / 2}
\end{equation*}
with coefficients (TODO: note on orthogonality or take this as known?)
\begin{equation*}
	\hat{u}_{mn} = \frac{1}{4} \integraltwo{u(x,y) e^{-i 2 \pi m x / 2} e^{-i 2 \pi n y / 2}}{x}{y}{-1}{+1}{-1}{+1}.
\end{equation*}
By the antisymmetry $u(x+1,y)=u(x,y+1)=-u(x,y)$ and the symmetry $u(x+1,y+1)=u(x,y)$, the Fourier coefficients satisfy
\begin{equation*}
	u_{m,n} = -u_{-m,n} = -u_{m,-n} = u_{-m,-n},
\end{equation*}
so $\hat{u}_{00} = -\hat{u}_{00} = 0$ and we can write the Fourier series as
\begin{equation*}
\begin{split}
	u(x,y) &= \sum_{m=1}^{+\infty} \sum_{n=1}^{+\infty} \hat{u}_{mn}
	\left( 
	  e^{+i \pi m x} e^{+i \pi n y}
	- e^{-i \pi m x} e^{+i \pi n y}
	- e^{+i \pi m x} e^{-i \pi n y}
	+ e^{-i \pi m x} e^{-i \pi n y}
	\right) \\
	       &= -4 \sum_{m=1}^{+\infty} \sum_{n=1}^{+\infty} \hat{u}_{mn} \sin(m \pi x) \sin(n \pi y)
\end{split}
\end{equation*}
after simplifying all complex expontentials using Euler's identity $e^{ix} = \cos x + i \sin x$.
Rescaling $\hat{u}_{mn} \rightarrow -\hat{u}_{mn}/4$, we then begin by expressing our analytical solution as the double sine series
\newcommand{\fourierseries}[3]{
	\sum_{#2=1}^{\infty} \sum_{#3=1}^{\infty} #1 \sin(#2 \pi x) \sin(#3 \pi y)
}
\newcommand{\fourierexpand}[1]{
	\fourierseries{\hat{#1}_{mn}}{m}{n}
}
\begin{equation}
u(x,y) = \fourierexpand{u}.
\label{pde:equation:fourierexpansion}
\end{equation}

Plug this Fourier series into \cref{eq:PDE} and act with the biharmonic operator to get
\begin{equation*}
\nabla^4 u(x,y) = \fourierseries{\left((m\pi)^2+(n\pi)^2\right)^2 \hat{u}_{mn}}{m}{n} = f(x,y).
\end{equation*}
For simplicity, we \textbf{restrict ourselves to sources that can also be written} (TODO: what restrictions does this impose on $f$?)
\begin{equation}
	f(x,y) = \fourierexpand{f}.
\end{equation}

The Fourier series for $\nabla^4 u(x,y)$ and $f(x,y)$ can be equal only if their coefficients are equal.
This can be seen formally by multiplying both by $\sin(2m'\pi x) \sin(2n'\pi y)$, integrating over $x$ and $y$ and using orthogonality of the sine functions,
\begin{equation*}
	\integral{\sin(m\pi x) \sin(m' \pi x)}{x}{0}{1} = \frac{1}{2} \delta_{mm'}.
\end{equation*}
Therefore, the coefficients of the solution are
\begin{equation}
	\hat{u}_{mn} = \frac{\hat{f}_{mn}}{\left((m\pi)^2+(n\pi)^2\right)^2},
\end{equation}
and the solution $u(x,y)$ is available by summing its Fourier series \ref{pde:equation:fourierexpansion}.

If we know $\hat{f}_{mn}$, it is straightforward to compute $\hat{u}_{mn}$ and thus the solution $u(x,y)$ itself from its Fourier series.
If we only know $f(x,y)$, we can find the coefficients by using the orthogonality of the sine functions again.
Multiply the Fourier series by $\sin(m' \pi x) \sin(n' \pi y)$ and integrate over $x$ and $y$ to get
\begin{equation*}
\begin{split}
  & \,\, \integraltwo{f(x,y) \sin(m' \pi x) \sin(n' \pi y)}{x}{y}{0}{1}{0}{1} \\
= & \,\, \sum_{m=1}^{\infty} \sum_{n=1}^{\infty} \hat{f}_{mn} \underbrace{\integral{\sin(m\pi x)\sin(m'\pi x)}{x}{0}{1}}_{\delta_{mm'}/2} \underbrace{\integral{\sin(\pi y)\sin(n'\pi y)}{y}{0}{1}}_{\delta_{nn'}/2} \\
= & \,\, \hat{f}_{m'n'} / 4.
\end{split}
\end{equation*}
Read from bottom to top,
\begin{equation}
\hat{f}_{mn} = 4 \integraltwo{f(x,y) \sin(m \pi x) \sin(n \pi y)}{x}{y}{0}{1}{0}{1}.
\end{equation}

Note that a general source $f(x,y)$ may only be represented exactly by an infinite Fourier series.
To make the Fourier series solution viable, we must cut it off to include only a finite number of terms.
In this case, we should analyze $f(x,y)$ to make sure that we exclude only Fourier modes that contribute insignificantly to the solution.
However, we can also construct problems with a finite number of terms in the \emph{exact} solution by simply defining the source $f(x,y)$ in terms of a finite number of nonzero Fourier coefficients.

%% b)

\subsection{Numerical solution method}

We may transform \eqref{eq:PDE} into a system of Poisson equation by introducing $g = \nabla^2 u$,
\begin{align}\label{eq:PDE-poisson}
  \nabla^2g &= f,\\
  \nabla^2u &= g,\\
  g = u &= 0,\quad \text{ on } \partial \Omega.
\end{align}


%% c)
In solving the poisson equation $\nabla^2 u = f$ will consider here two discretization schemes, the five point stencil and nine point stencil, which we will denote $\nabla_5^2$ and $\nabla_9^2$.

\newcommand{\crossStencil}[5]{%
  \begin{tikzpicture}[scale=0.5,baseline=1mm, every node/.style={scale=0.7}, nodes={draw, circle}]
    \draw node[below]{$#1$} (0,0) -- (0,2) node[above]{$#2$};
    \draw (-1, 1) node[left]{$#3$} -- (1, 1) node[right]{$#4$};
    \node[above right, draw=none] at (0,1) {$#5$};
  \end{tikzpicture}
}

\newcommand{\xStencil}[4]{%
  \begin{tikzpicture}[scale=0.5,baseline=1mm, every node/.style={scale=0.7}, nodes={draw, circle}]
    \draw node[below left]{$#1$} (0,0) -- (1.41, 1.41) node[above right]{$#2$};
    \draw (0, 1.41) node[above left]{$#3$} -- (1.41, 0) node[below right]{$#4$};
  \end{tikzpicture}
}

Written in stencil diagrams, the five point stencil is given as 
$$
u \left(\crossStencil{1}{1}{1}{1}{-4}\right) = h^2 f
$$
while the nine point stencil is given by
$$
u
\left(
\xStencil{\frac16}{\frac16}{\frac16}{\frac16}
+
\crossStencil{\frac23}{\frac23}{\frac23}{\frac23}{-\frac{10}{3}}
\right)
=
h^2
f
\left(
\crossStencil{\frac1{12}}{\frac1{12}}{\frac1{12}}{\frac1{12}}{\frac23}
\right).
$$


We will now describe the structure of the matricies involved in the problem, starting with the simpler five point stencil.
We will use the same flattening for the 2D discrete function $u$ as described in section \ref{sec:exc3:numerical}.
We recognize that in $U$ neighbouring elements correspond to grid points that are left and right of each other, while the grid point up and down is the element N places before and after.
Thus, writing out the five point stencil $K2D$, we get a toeplitz and symmetric matrix, where the main diagonal has -4 and the $\pm 1$ and $\pm N$ off diagonals have 1.
We can compactley write this as
$$
K2D =
\begin{bmatrix}
  K & 0 \\
  0 & K & 0\\
  0 & 0 & K \\
  &&&\ddots
\end{bmatrix}
+
\begin{bmatrix}
  -2I & I & 0 &  \\
  I & -2I & I & 0 \\
  0 & I & -2I & I & 0 \dots\\
  \vdots&&&\ddots
\end{bmatrix}.
$$
where $I$ is the identity matrix and $K$ is the one dimensional central finite difference matrix of order 2,
$$
K =
\begin{bmatrix}
  -2 & 1 &   \\
  1 & -2 & 1 &  \\
  & 1 & -2 & 1 & \\
  &&&\ddots\\
  && 1 & -2 & 1\\
  &&& 1 & -2
\end{bmatrix}.
$$
Using the Kronecker product, this may be written as
$$
K2D = \verb|kron|(I, K) + \verb|kron|(K, I)
$$
which is useful when working with sparse matricies.

We will split the nine point stencil matrix into two, according to the stencil diagram above.
One matrix represents a five point stencil with weights altered to $\frac{-10}{3}, \frac23$ instead of $-4, 1$, we denote this matrix by $K2D^{(9)}$.
The other is the ``X''-stencil taking care of the NE, NW, SE, and SW points, each with a weight of $\frac16$, as shown in the diagram.
We will denote this matrix by $\Sigma 2D$.

Let
\begin{equation}
  \Sigma =
  \frac{1}{\sqrt{6}}
  \begin{bmatrix}
    0 & 1  \\
    1 & 0 & 1 \\
      & 1 & 0 & 1 \\
      &   & 1 & 0 & \ddots\\
      &   &   & \ddots  & \ddots
  \end{bmatrix}
\end{equation}
be the TST matrix with ones on its off-diagonals and zero on the diagonal.
Then we have $\Sigma 2D = \Sigma \otimes \Sigma$.
The nine point stencil is then
\begin{equation}
  somename9stencil = K2D^{(9)} + \Sigma 2D
\end{equation}

The eigenvalues of the Kronecker product $A \otimes B$ is the product of the eigenvalues of $A$ and $B$.
The eigenvalue of the Kronecker sum $A\oplus B = A \otimes I + I \otimes B$ is the sum of eigenvalues of $A$ and $B$.
(TODO: these are non-obvious properties, need a reference, e.g. \url{http://www.siam.org/books/textbooks/OT91sample.pdf} theorem 13.12 and 13.16)
% Some properties/proofs in https://www.uio.no/studier/emner/matnat/ifi/nedlagte-emner/INF-MAT3350/h07/undervisningsmateriale/chap9slides.pdf
In general the eigenvalues of a TST matrix are
\begin{equation*}
	\lambda_k = a + 2 b \cos\left(\frac{k \pi}{N + 1}\right)
\end{equation*}
where $a$ is the main diagonal and $b$ is the off diagonal.
%% Thus the eigenvalues of $K$ are
%% $$
%% \lambda_k = -2
%% \left(1 - \cos\left(\frac{k \pi}{N + 1}\right)\right)
%% $$
%% and the eigevalues of $\Sigma$ are
%% $$
%% \gamma_k = -\frac{2}{\sqrt{6}}\cos\left(\frac{k \pi}{N + 1}\right).
%% $$
Thus, the eigenvalues of $K2D$ are
$$
\left(-2 + 2\cos\left(\frac{k \pi}{N + 1}\right)\right)
+
\left(-2 + 2\cos\left(\frac{l \pi}{N + 1}\right)\right).
$$
The eigenvalues of $K2D^{(9)}$ are
$$
\frac13\left(-10 + 4\cos\left(\frac{k \pi}{N + 1}\right)\right)
+
\frac13\left(-10 + 4\cos\left(\frac{l \pi}{N + 1}\right)\right)
$$
and the eigenvalues of $\Sigma \otimes \Sigma$ are
$$
\frac46
\cos\left(\frac{k \pi}{N+1}\right)
\cos\left(\frac{l \pi}{N+1}\right).
$$
The eigenvalues of the nine point stencil are thus
\begin{equation}
  -\frac{10}{3}
  + \frac43
  \left(
  \cos(\frac{k \pi}{N+1})
  + \cos(\frac{l \pi}{N+1})
  \right)
  +
  \frac46
  \cos(\frac{k \pi}{N+1})
  \cos(\frac{l \pi}{N+1}).
\end{equation}

%% Let us defne an infinity norm for convenience
\newcommand{\inorm}[1]{
\lVert #1 \rVert_\infty
}

\subsection{Stability and order of the five and nine point stencils}
\begin{definition}
  The $n$-point stencil $\nabla_n^2 f(x_0) = \sum_{i=0}^{n-1} a_i f(x_i)$,
  where $x_i$ are the neighbouring points of $x_0$.
\end{definition}

\begin{definition}
  We denote by a proper stencil a stencil where $a_i > 0$ for $i>0$ and $\sum_{i=1}^n a_i = -a_0$.
\end{definition}

\begin{lemma}\label{pde:lemma:max}
If $\nabla_n^2 f \geq 0$ on $\Omega$, and $\nabla_n^2$ is a proper stencil, the maximum value of $f$ is attained on $\partial \Omega$, that is
$$
\max(f)_\Omega \leq \max(f)_{\partial \Omega}.
$$
\end{lemma}
\begin{proof}
Suppose the opposite is true,
$$
\max(f)_\Omega > \max(f)_{\partial \Omega}.
$$
Then, there is an internal grid point $x_0$ on which $f$ attains it maximal value.
Then
\begin{equation}
  -a_0 f(x_0)
  = \sum_{i=1}^{n-1} a_i f(x_i) - \nabla_n^2 f(x_0)
  \leq \sum_{i=1}^{n-1} a_i f(x_i)
  \leq \sum_{i=1}^{n-1} a_i f(x_0)
  = -a_0 f(x_0).
\end{equation}
As the RHS is equal to the LHS, the equality must hold throughout.
Since $f(x_i) \leq f(x_0)$ all points of the stencil must be equal, $f(x_1) = f(x_2) = \dots = f(x_n) = f(x_0)$.
Applying this same argument to each of the neighbours, and then to their neighbours and so on, we ultimately reach the conclusion that the same value is also attained on $\partial \Omega$, and we thus have a contradiction.
\end{proof}

\begin{lemma}\label{pde:lemma:bound}
  If $\exists ~ \phi_n > 0$ such that the proper stencil $\nabla_n^2 \phi_n = 1$ on $\Omega$, and $v$ is a descrete function that equals zero on $\partial \Omega$, then
  \begin{equation}
    \inorm{v} \leq \max_{\partial\Omega}(\lvert \phi_n \rvert)
    \inorm{\nabla_n^2 v}.
  \end{equation}
\end{lemma}
\begin{proof}

Let $\inorm{\nabla_n^2 v} = M$.
Then
$$
\nabla_n^2 (v + \phi_n M) = \nabla_n^2 v +  M \geq 0.
$$
$\nabla_n^2$ is a proper stencil, so by lemma \ref{pde:lemma:max} $\nabla_n^2 (v + \phi_n M)$ attains its maximum value on $\partial \Omega$.
Thus
$$
\inorm{v}
\leq \inorm{v + \phi_n M}
\leq \max_{\partial \Omega}(\lvert v + \phi_n M\rvert)
= \max_{\partial\Omega} (\lvert \phi_n \rvert) M
= \max_{\partial\Omega} (\lvert \phi_n \rvert) \inorm{\nabla_n^2 v}.
$$
\end{proof}

\begin{remark}
  For the five and nine point stencil, such functions exist.
  \begin{equation}
    \phi_5(x,y) = \frac14 \left(\left(x-\frac12\right)^2 + \left(y-\frac12\right)^2\right)
    \label{pde:equation:phi5}
  \end{equation}
  has the property $\nabla_5^2 \phi_5(x,y) = 1$, takes the values $0 \leq \phi_5(x,y) \leq 1/8$ on $\Omega$ and attains the maximum on $\partial \Omega$.
    
  \newcommand{\phinine}{\frac{1}{5} \left(\left(x-\frac{1}{2}\right)^4+\left(y-\frac{1}{2}\right)^4\right) - \frac{6}{5} \left(x-\frac{1}{2}\right)^2\left(y-\frac{1}{2}\right)^2 + \frac{1}{4} \left(\left(x-\frac{1}{2}\right)^2+\left(y-\frac{1}{2}\right)^2\right)}
  Similarly, the function
  \begin{equation}
  \phi_9(x,y) = \phinine
  \label{pde:equation:phi9}
  \end{equation}
  is such that $\nabla_9^2 \phi_9(x,y) = 1$, takes the values $0 \leq \phi_9(x,y) \leq 3/40$ on $\Omega$ and attains the maximum on $\partial \Omega$.
  Both are shown in \cref{pde:figure:phi}.
\end{remark}

\newcommand{\phidisplay}[3]{
\begin{tikzpicture}
\begin{axis}[
	width=8.2cm, height=7.5cm,
	zmin=0.0,
	xlabel=$x$, xtick distance=0.25,
	ylabel=$y$, ytick distance=0.25,
	ztick={0,#2}, zticklabels={0,#2},
	scaled ticks=false,
	grid,
	title={$#3$},
]
	\addplot3 [
		surf,
		domain=0:1,
	] {#1};
\end{axis}
\end{tikzpicture}
}

\begin{figure}[t]
\centering
\phidisplay{1/4*((x-1/2)^2+(y-1/2)^2)}{1/8}{\phi_5(x,y)}
\phidisplay{1/5*((x-1/2)^4+(y-1/2)^4)-6/5*(x-1/2)^2*(y-1/2)^2+1/4*((x-1/2)^2+(y-1/2)^2)}{3/40}{\phi_9(x,y)}
\caption{\label{pde:figure:phi}The functions $\phi_5(x,y)$ and $\phi_9(x,y)$ range from $\phi_5(\frac12,\frac12)=\phi_9(\frac12,\frac12)=0$ at the center to $\phi_5(0,0) = 1/8$ and $\phi_9(0,0)=3/40$ at the boundaries of $[0,1]\times[0,1]$.}
\end{figure}

%% 3
\begin{theorem}[Five point stencil stability]
If $\nabla^2 u = f$ and $\nabla_5^2 v = f$, then
$$
\inorm{u - v} \leq Ch^4 \lvert D^4 v\rvert_\infty.
$$
\end{theorem}
\begin{proof}
By lemma \ref{pde:lemma:bound}
$$
\inorm{u - v} \leq \frac18 \inorm{\nabla_5^2 (u  - v)}.
$$
By Taylor expanding $u(x + h, y)$ and $u(x - h, y)$ we get
$$
\frac{1}{h^2} \delta_x^2 u = \partial_x^2 u + \frac{h^2}{12} \partial_x^4 + \mathcal{O}(h^4),
$$
and similarly for $y$.
Therefore we get, to order $h^2$
\begin{align*}
  \nabla_5^2 u
  &=\frac{1}{h^2} (\delta_x^2 + \delta_y^2) u\\
  &= (\partial_x^2 + \partial_y^2 + \frac{h^2}{12} \partial_x^4 + \frac{h^2}{12} \partial_y^4) u\\
  &\leq \nabla^2 u + \frac{h^2}{12} \max(\partial_x^4 u, \partial_y^4 u)\\
  &\leq \nabla^2 u + C h^2 \lvert D^4 u \rvert_\infty.
\end{align*}
Here $\lvert D^n u\rvert_\infty$ is to be understood as the maximal value of all $n$-index derivatives of $u$.
For example for $D^2$ this would be $u_{xx}, u_{xy}, u_{yx}, \text{and } u_{yy}$.
\end{proof}


%% 3
\begin{theorem}[Nine point stencil stability]
TODO verify it should be $F f$ not $f$.
If $\nabla^2 u = f$ and $\nabla_9^2 v = F f = f + \frac{h^2}{12} \nabla_5^2 f$, then
$$
\inorm{u - v} \leq Ch^2 \lvert D^6 v\rvert_\infty.
$$
\end{theorem}
\begin{proof}
By lemma \ref{pde:lemma:bound}
$$
\inorm{u - v} \leq \frac{3}{40} \inorm{\nabla_9^2 (u  - v)}.
$$
Taylor expanding $\nabla_9^2 u$, similarly to what was done in the five point stencil case, we get
\begin{align*}
  \nabla_9^2 u
  &= (\nabla^2
  + \frac{h^2}{12} \partial_x^4
  + \frac{h^2}{12} \partial_y^4
  + \frac{h^2}{6} \partial_x^2 \partial_y^2
  ) u + h^4 C \mathcal{O}(D^6 u)\\
  &= \nabla^2 u + \frac{h^2}{12} \nabla^2 f + C h^4 \mathcal{O}(D^6 u).
\end{align*}
Here $\mathcal{O}(D^n u)$ is to be understood as terms involving $n$-index derivatives of $u$.
Notice that
$$
\nabla^2 f = \nabla_5^2 f + C h^2 \mathcal{O}(D^4 f),
$$
and that $\mathcal{O}(D^4 f)
= \mathcal{O}(D^4 \nabla^2 u)
= \mathcal{O}(D^6 u)$.

Thus
\begin{align}
  \inorm{\nabla_9^2 (u  - v)}
  &= \inorm{Ch^4 \mathcal{O}(D^6u)}\\
  &\leq Ch^4 \inorm{D^6u}
\end{align}
\end{proof}



\subsection{The Fast Poisson Solver}
We are to solve the equation
$$
A U = F.
$$
Assuming that the eigenvectors of $A$ are a complete set, we may write
$$
F = a_1 y_1 + a_2 y_2 + ...,
$$
where $y_1, y_2, \dots$ are the eigenvectors of $A$.
(TODO: $U$ is also expanded in the eigenvectors?)
The solution $U$ is the of course
$$
U =
\frac{a_1}{\lambda_1} y_1
+ \frac{a_2}{\lambda_2} y_2
+ \dots,
$$
where $\lambda_i$ is the eigenvalue corresponding to $y_i$.
In general, however, this is not a viable way to solve the problem, as it requires knowing all the eigenvalues and eigenvectors, as well as finding the coefficients $a_i$.
However, for the set of eigenvectors in this problem, which are sines, we have a very efficient algorithm for computing the coefficients, the discrete fast sine transform.
We also have simple analytical expressions for the eigenvalues.

Written as matrix expressions
\begin{align}
  A U &= F\\
  S\Lambda S U &= F\\
  &\Rightarrow\\
  U &= S\Lambda^{-1} S F,
\end{align}
where we used the fact that $S^{-1} = S$.
Moreover, formulated more directly with regards to implementing the solver, we have that the solution is
$$
U = IFST(FST(F) / \Lambda),
$$
where $IFST, FST$ are the inverse and normal fast sine tranform.

\subsection{Demonstration of order}
\begin{figure}[h]
  \centering
  \input{./PDE/order.pgf}
  \caption{Error as a function discretization points $N$
    TODO: figure is to be updated with prettier figure
    TODO: Most appropriate with function of h or N?}
\end{figure}


\subsection{Solving the Biharmonic equation}
Consider the equation
\begin{align*}
  \nabla^4 u &= f(x, y) &(x, y) &\in \phantom{\partial}\Omega\\
  u = \nabla^2u &= 0  &(x, y) &\in \partial\Omega
\end{align*}
where $f(x, y) =
\left(
\sin \pi x
\sin \pi y
\right)^4
e^{-(x-0.5)^2 - (y-0.5)^2}
$.

